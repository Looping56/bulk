<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Lego Pro Manager - Commande & Admin</title>
    <style>
        :root { --lego-red: #d1121b; --lego-blue: #0055ad; --lego-yellow: #ffcf00; --dark: #222; }
        body { font-family: 'Segoe UI', sans-serif; background: #f4f4f4; margin: 0; padding: 20px; }
        .app-container { max-width: 600px; margin: auto; background: white; border-radius: 15px; border: 5px solid var(--dark); overflow: hidden; }
        
        .header { background: var(--dark); color: white; padding: 20px; text-align: center; }
        .section { padding: 20px; display: none; }
        .active { display: block; }

        /* Style des Vignettes */
        .piece-row { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 5px; background: #eee; border-radius: 8px; }
        .vignette { width: 50px; height: 50px; background: #ddd; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 10px; }
        
        .btn { width: 100%; padding: 15px; margin-top: 10px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: white; }
        .btn-blue { background: var(--lego-blue); }
        .btn-green { background: #237841; }
        .btn-admin { background: #666; }

        .admin-controls { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">
        <h2>LEGO SYSTEM PRO</h2>
        <div id="user-tag">Session : 2026</div>
    </div>

    <div id="menu" class="section active">
        <input type="text" id="member-name" placeholder="Votre Nom / Pseudo" style="width:94%; padding:15px; margin-bottom:10px;">
        <button class="btn btn-blue" onclick="showSection('selection')">1. S√©lectionner mes 11 pi√®ces</button>
        <button class="btn btn-green" onclick="genererBon()">2. G√©n√©rer mon Bon de Commande</button>
        <button class="btn btn-admin" onclick="checkAdmin()">Administration üîí</button>
    </div>

    <div id="selection" class="section">
        <h3>Ma S√©lection (11 pi√®ces)</h3>
        <div id="list-container"></div>
        <button class="btn btn-blue" onclick="saveSelection()">Enregistrer ma S√©lection</button>
        <button class="btn btn-admin" onclick="showSection('menu')">Retour</button>
    </div>

    <div id="admin" class="section">
        <h3>Panneau de Contr√¥le Final</h3>
        <div class="admin-controls">
            <button class="btn btn-green" onclick="exportData()">Exporter CSV (BrickLink)</button>
            <button class="btn btn-blue" onclick="importData()">Importer S√©lection Finale</button>
        </div>
        <div id="stats-area" style="margin-top:20px; padding:10px; background:#f9f9f9; border:1px solid #ccc;">
            <strong>Statistiques :</strong> <span id="total-orders">0</span> commandes en attente.
        </div>
        <button class="btn btn-admin" onclick="showSection('menu')">Quitter Admin</button>
    </div>
</div>

<script>
    // Initialisation des 11 lignes
    const list = document.getElementById('list-container');
    for(let i=1; i<=11; i++) {
        list.innerHTML += `
            <div class="piece-row">
                <div class="vignette" id="vignette-${i}">IMG</div>
                <input type="text" placeholder="R√©f" id="ref-${i}" style="width:60px" oninput="updateVignette(${i})">
                <select id="col-${i}" style="flex:1">
                    <option>Black</option><option>White</option><option>Red</option><option>Blue</option>
                </select>
            </div>`;
    }

    function showSection(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function updateVignette(id) {
        const ref = document.getElementById(`ref-${id}`).value;
        const vig = document.getElementById(`vignette-${id}`);
        if(ref.length > 2) {
            // Ici on pourrait lier une image : bricklink.com/v2/catalog/catalogitem.page?P=${ref}
            vig.innerHTML = `<img src="https://img.bricklink.com/ItemImage/PN/11/${ref}.png" style="width:100%" onerror="this.src='Lego'">`;
        }
    }

    function checkAdmin() {
        const p = prompt("Mot de passe :");
        if(p === "admin123") showSection('admin');
    }

    function genererBon() {
        const name = document.getElementById('member-name').value;
        if(!name) return alert("Entrez votre nom !");
        alert("Bon de commande g√©n√©r√© pour " + name + " (Fichier PDF/Texte pr√™t).");
    }

    function exportData() {
        alert("Exportation des donn√©es au format .CSV pour BrickLink...");
    }
</script>
</body>
</html>
